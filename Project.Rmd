---
title: "Project"
author: "Thanh Trinh"
date: "April 18, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction 
We are interested in which variables affect the starting salary for an initial job offer the most. We have developed the following questions that we will explore:

- How much does having an internship affect your starting salary
- Does it matter if the internship is related to the respective major?
- How much does one internship differ from many? 



```{r}
# Connect to DB
library(tidyverse)
conStudent <- src_mysql(
                   host = "ba-isdsclass-programdev.lsu.edu",
                  port = 3306,
                  user = 'student',
                  password = 'student',
                  dbname = "isds_3105")



graduates <- tbl(conStudent, 'graduation')
internships <- tbl(conStudent, 'internship')
wage <- tbl(conStudent, 'paidInternship')

# Filter to join hourly wage and remove results that have NA for that column, sort by ascending
internships <- internships %>% left_join(wage) %>% filter(!is.na(hourlyWage))

internships <- internships %>% left_join(graduates) %>% arrange(graduationId)


```

We have realized that there is a large sum of "dirty" data, and will thus do some cleanup. Some hourly wages appear to be above $40-$45, which seems very unreasonable for even out of state internships in high cost-of-living states such as California. That being said, I will filter out the results greater than $40/h. 


```{r}
internships <- internships %>% filter(hourlyWage <= 45) %>% select(internshipId, jobTitle, graduationId, weeklyCompensation, hourlyWage)


# Counts num of internships for a given student
internship_amounts <- internships %>% as.data.frame %>% group_by(graduationId) %>% summarise(count = n()) %>% arrange(graduationId)

# This variable holds the amount of students with 1 internship, 2 internships, or 3 internships (2408, 630, and 141 respectively)
totalAmounts <- internship_amounts %>% group_by(count) %>% summarise(countCOUNT=n())
```


## How many internships did most students have? 
```{r}
ggplot(totalAmounts) + geom_col(aes(x = count, y = countCOUNT, fill = count)) + ggtitle("Total Amount of Internships by Graduation") + labs(x="Number of internships", y = "Amount of Students")
```

```{r}
#get salary from students with internships
curPos <- tbl(conStudent, 'currentPosition')
employ <- tbl(conStudent, 'employment')
full_time <- tbl(conStudent, 'fulltime')

#holds students with AND without internships
currentPos <- internship_amounts %>% right_join(curPos, by = 'graduationId', copy = T) %>% select(graduationId, count, idCurrentPosition)

currentPos2 <- internship_amounts %>% right_join(curPos, by = 'graduationId', copy = T) %>% select(graduationId, count, idCurrentPosition) %>% filter(!is.na(count))

employment <- currentPos %>% left_join(employ, by = 'idCurrentPosition', copy = T) %>% filter(!is.na(count))

internSalary <- employment %>% left_join(full_time, by = 'idCurrentPosition', copy = T) %>% filter(!is.na(count)) %>% select(graduationId, count, salary)
```


